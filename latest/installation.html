<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; SFRmaker 0.11.1.post13.dev0+gf681dbf documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=9c7ba1cc"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Input data requirements" href="inputs.html" />
    <link rel="prev" title="Using SFRmaker with a configuration file" href="examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SFRmaker
          </a>
              <div class="version">
                0.11.1.post13.dev0+gf681dbf
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="philosophy.html"> Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html"> Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-python-dependencies-with-conda">Installing python dependencies with Conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-and-install-a-python-distribution-and-conda-like-package-manager">Download and install a python distribution and Conda-like package manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-an-environment-file">Download an environment file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-conda-environment-using-mamba">Creating a Conda environment using Mamba</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keeping-the-conda-environment-up-to-date">Keeping the Conda environment up to date</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installing-sfrmaker">Installing SFRmaker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-and-updating-sfrmaker-from-pypi">Installing and updating SFRmaker from PyPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-latest-develop-version-of-sfrmaker">Installing the latest develop version of SFRmaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-sfrmaker-source-code-in-place">Installing the SFRmaker source code in-place</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-ipython-kernel-to-use-sfrmaker-in-jupyter-notebooks">Installing the IPython kernel to use SFRmaker in Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#considerations-for-usgs-users-or-anyone-else-with-an-organizational-ssl-certificate">Considerations for USGS Users (or anyone else with an organizational SSL certificate)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Installing the DOI SSL certificate for use with pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Installing the DOI SSL certificate for use with git</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-doi-ssl-certificate-for-use-with-conda">Installing the DOI SSL certificate for use with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-issues-with-the-usgs-network">Troubleshooting issues with the USGS network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssl-related-error-messages-when-using-conda">SSL-related error messages when using conda</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-related-error-messages-when-using-building-a-conda-environment-or-using-pip">SSL-related error messages when using building a conda environment or using pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="#if-you-are-on-the-usgs-network-using-windows-and-you-get-this-error-message">If you are on the USGS network, using Windows, and you get this error message:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="inputs.html"> Input Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html"> Using SFRmaker with a configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/SFRmaker_demo.html"> Basic Usage in a scripting context</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/preprocessing_demo.html"> Preprocessing NHDPlus version 2 data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/lines_from_NHDPlusHR_demo.html"> Using SFRmaker with NHDPlus High Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html"> Concepts and methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/sfrmaker_tools.html"> Stand-alone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html"> Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html"> Code reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-summary.html"> Summary of configuration file options</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html"> Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html"> Contributing to SFRmaker</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html"> References cited</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SFRmaker</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h1>
<section id="installing-python-dependencies-with-conda">
<h2>Installing python dependencies with Conda<a class="headerlink" href="#installing-python-dependencies-with-conda" title="Link to this heading">¶</a></h2>
<p>SFRmaker depends on a number of python packages, many of which have external C library dependencies. The easiest way to install most of these is with a package installer like <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a>. A few packages are not available via conda, and must be installed with <a class="reference external" href="https://packaging.python.org/tutorials/installing-packages/#use-pip-for-installing">pip</a>. If you are on the USGS internal network, see the <a class="reference internal" href="#considerations-for-usgs-users">Considerations for USGS Users</a> section below first.</p>
<section id="download-and-install-a-python-distribution-and-conda-like-package-manager">
<h3>Download and install a python distribution and Conda-like package manager<a class="headerlink" href="#download-and-install-a-python-distribution-and-conda-like-package-manager" title="Link to this heading">¶</a></h3>
<p>There are many ways to do this:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda python distribution</a> comes with a large selection of popular data science and scientific packages pre-installed.</p></li>
<li><p><a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a> is a minimal installer with a much smaller footprint, making it ideal for creating python environments dedicated to specific tasks (a recommended practice).</p></li>
<li><p><a class="reference external" href="https://github.com/conda-forge/miniforge#mambaforge">Mambaforge</a> is like Miniconda, but pre-configured to use the <a class="reference external" href="https://mamba.readthedocs.io/en/latest/">Mamba</a> installer, and only the <a class="reference external" href="https://conda-forge.org/docs/user/introduction.html">conda-forge</a> channel for getting packages (more below). If the above two options don’t work (for example, the Conda installer fails or gets stuck on the “solve” step), this may be your best option.</p></li>
</ul>
</div></blockquote>
<p><strong>Make sure to install the python distribution to your username</strong> (not at the system level). More often than not, installing at the system level (for all users) seems to result in issues with library dependencies (for example, import of <code class="docutils literal notranslate"><span class="pre">fiona</span></code> or <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> failing because gdal isn’t found). It is also good practice to periodically do a <a class="reference external" href="https://docs.anaconda.com/anaconda/install/uninstall/">clean uninstall</a> of Anaconda, which at the system level requires admin. privileges.</p>
<dl class="simple">
<dt>Mambaforge-specific instructions:</dt><dd><ul class="simple">
<li><p>If after downloading the Mambaforge installer you get a message that it “isn’t commonly downloaded” and the option to “Trust” it is grayed out (because you don’t have sufficient rights), try using a different browser like Google Chrome (for example, if you were using Microsoft Edge).</p></li>
<li><p>Once the installer is running, go against the recommendation and <strong>select the option to add Mambaforge to the system path for your user.</strong></p></li>
</ul>
</dd>
<dt>Anaconda-specific instructions:</dt><dd><ul class="simple">
<li><p>In the installer, at the “Destination Select” step, select “Install for me only.” It should say something about how the software will be installed to your home folder.</p></li>
<li><p>If your installer skips the “Destination Select” step, when you get to “Installation Type”, click “Change Install Location” and then “Install for me only.”</p></li>
</ul>
</dd>
</dl>
</section>
<section id="download-an-environment-file">
<h3>Download an environment file<a class="headerlink" href="#download-an-environment-file" title="Link to this heading">¶</a></h3>
<blockquote>
<div><ul>
<li><p><a class="reference external" href="https://raw.githubusercontent.com/aleaf/sfrmaker/master/requirements.yml">requirements.yml</a> for a <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/environments.html">conda environment</a> with the minimum packages required to run SFRmaker, or</p></li>
<li><p><a class="reference external" href="https://raw.githubusercontent.com/aleaf/sfrmaker/master/gis.yml">gis.yml</a> for a more full set of packages in the python geospatial stack, including Jupyter Notebooks and packages needed for testing, documentation and packaging. Note that the environment described by <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> is called <cite>sfrmaker</cite>, while the environment in <code class="docutils literal notranslate"><span class="pre">gis.yml</span></code> is called <cite>gis</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To download the above YAML files, simply follow the links to get the raw text and then go to File &gt; Save within your web browser, and save the text as a YAML file (with the <cite>.yaml</cite> or <cite>.yml</cite> extension).</p>
</div>
</li>
<li><p>Alternatively, clone (<a class="reference external" href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">using git</a>) or <a class="reference external" href="https://github.com/aleaf/sfrmaker/archive/master.zip">download</a> the SFRmaker repository, which includes the two environment files at the root level.</p></li>
<li><p>Note that both of these environment files contain a <code class="docutils literal notranslate"><span class="pre">pip</span></code> section of packages that will be installed with pip, after the Conda packages are installed.</p></li>
</ul>
</div></blockquote>
</section>
<section id="creating-a-conda-environment-using-mamba">
<h3>Creating a <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/environments.html">Conda environment</a> using <a class="reference external" href="https://mamba.readthedocs.io/en/latest/">Mamba</a><a class="headerlink" href="#creating-a-conda-environment-using-mamba" title="Link to this heading">¶</a></h3>
<p>If you are on the USGS internal network, see the <a class="reference internal" href="#considerations-for-usgs-users">Considerations for USGS Users</a> section below first.</p>
<p>While Conda can of course be used to create a Conda environment, the Mamba package solver is generally faster and more robust, especially for larger, more complex environments like the included <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code>. Mamba is a reimplementation of the conda package manager in C++.</p>
<p>Before using Mamba, you will need to <a class="reference external" href="https://mamba.readthedocs.io/en/latest/installation.html">install it first</a>.</p>
<p>Python packages are available from conda via channels. Conda comes preconfigured to install packages from the default channel, which is maintained by Anaconda, Inc. In general, you may have better luck exclusively using the <a class="reference external" href="https://conda-forge.org/docs/user/introduction.html">conda-forge</a> channel instead, which is community-based and intended to provide a single location to get any package, with a minimum of hassle. In general, it is bad practice to mix package channels within a single environment. You can read more <a class="reference external" href="https://conda-forge.org/docs/user/introduction.html">here</a>, but to set conda-forge as the default:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>config<span class="w"> </span>--add<span class="w"> </span>channels<span class="w"> </span>conda-forge
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are having trouble installing Mamba (for example, the conda package solver fails when you try to install it, or takes an excessively long time), you may have better luck uninstalling <a class="reference external" href="cleanuninstall">Anaconda completely</a> and installing <a class="reference external" href="https://github.com/conda-forge/miniforge#mambaforge">Mambaforge</a> instead, as directed in the Mamba install instructions. Mambaforge solves both of the above problems by providing a minimal python distribution and conda-style package installer that is preconfigured to use both <a class="reference external" href="https://conda-forge.org/docs/user/introduction.html">conda-forge</a> and <a class="reference external" href="https://mamba.readthedocs.io/en/latest/">Mamba</a>.</p>
</div>
<p>Once you have a python distribution and mamba installed, to create the conda environment, open a new Anaconda Command Prompt on Windows or a new terminal window on OSX and point it to the location of <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> or <code class="docutils literal notranslate"><span class="pre">gis.yml</span></code> and enter:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>requirements.yml


..<span class="w"> </span>note::
<span class="w">    </span>Creating<span class="w"> </span>the<span class="w"> </span><span class="sb">``</span>requirements.yml<span class="sb">``</span><span class="w"> </span>environment<span class="w"> </span><span class="o">(</span>or<span class="w"> </span>any<span class="w"> </span>environment<span class="w"> </span>with<span class="w"> </span><span class="sb">``</span>git+https:<span class="w"> </span>...<span class="sb">``</span><span class="w"> </span>installs<span class="o">)</span><span class="w"> </span>requires<span class="w"> </span>Git<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>installed<span class="w"> </span>and<span class="w"> </span>visible<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>system<span class="w"> </span>path<span class="w"> </span>where<span class="w"> </span><span class="sb">``</span>env<span class="w"> </span>create<span class="sb">``</span><span class="w"> </span>is<span class="w"> </span>being<span class="w"> </span>run.<span class="w"> </span>If<span class="w"> </span>Git<span class="w"> </span>is<span class="w"> </span>installed<span class="w"> </span>and<span class="w"> </span>somehow<span class="w"> </span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>system<span class="w"> </span>path,<span class="w"> </span>it<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>added<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>system<span class="w"> </span>path<span class="w"> </span>on<span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>without<span class="w"> </span>admin.<span class="w"> </span>rights<span class="w"> </span>via<span class="w"> </span>the<span class="w"> </span><span class="s2">&quot;environment variables&quot;</span><span class="w"> </span>editor<span class="w"> </span>under<span class="w"> </span>User<span class="w"> </span>Accounts<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>Control<span class="w"> </span>Panel<span class="w"> </span><span class="o">(</span>Google<span class="w"> </span>it<span class="o">)</span>.
</pre></div>
</div>
<p>Building the environment will probably take a while. If the build fails because of an SSL error, fix the problem (see <a class="reference internal" href="#considerations-for-usgs-users">Considerations for USGS Users</a> below) and either:</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>Update the environment</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>env<span class="w"> </span>update<span class="w"> </span>-f<span class="w"> </span>requirements.yml
</pre></div>
</div>
</li>
<li><p>or remove and reinstall it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>remove<span class="w"> </span>-n<span class="w"> </span>sfrmaker
mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>requirements.yml
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
</section>
<section id="keeping-the-conda-environment-up-to-date">
<h3>Keeping the Conda environment up to date<a class="headerlink" href="#keeping-the-conda-environment-up-to-date" title="Link to this heading">¶</a></h3>
<p>The python packages and other open source software libraries that SFRmaker depends on are continually changing. SFRmaker aims to mostly follow the <a class="reference external" href="https://numpy.org/neps/nep-0029-deprecation_policy.html">Numpy guidelines for package support</a>, which effectively means that the two latest minor versions of Python (e.g. 3.11 and 3.10) and their associated Numpy versions will be supported. However, occasionally backwards compatability with a particular package may be broken in a shorter timeframe, in which case the minimum required version of that package will be specified in the <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> file. All of this to say that your Conda environment will eventually get out of date. The <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Conda documentation</a> has instructions for updating packages within a Conda environment, but at some point (perhaps a few times a year) it is good practice to simply delete the environment and rebuild it from the <cite>.yml</cite> file. Every so often, you may also want to reinstall Anaconda after a <a class="reference external" href="https://docs.anaconda.com/anaconda/install/uninstall/">clean uninstall</a>.</p>
</section>
</section>
<section id="installing-sfrmaker">
<h2>Installing SFRmaker<a class="headerlink" href="#installing-sfrmaker" title="Link to this heading">¶</a></h2>
<p>There are several ways to install SFRmaker. Regardless of the method, the installation must be performed in a python
environment with the required dependencies. In the case of the Conda environment created above, the environment must be activated, so that right version of python is called when <code class="docutils literal notranslate"><span class="pre">python</span></code> is entered at the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>sfrmaker
</pre></div>
</div>
<section id="installing-and-updating-sfrmaker-from-pypi">
<h3>Installing and updating SFRmaker from <a class="reference external" href="https://pypi.org/">PyPI</a><a class="headerlink" href="#installing-and-updating-sfrmaker-from-pypi" title="Link to this heading">¶</a></h3>
<p>Once a suitable conda environment (that contains ALL of the dependencies) is made and activated, the simplest way to install SFRmaker is from the Python Package Index using pip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>sfrmaker
</pre></div>
</div>
<p>Subsequent releases of SFRmaker to PyPI can then be installed with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>sfrmaker
</pre></div>
</div>
<p>Note that in some situations you may have to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">sfrmaker</span></code> and then <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sfrmaker</span></code>. You can always check
what version of sfrmaker you have within a python session with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sfrmaker</span>
<span class="n">sfrmaker</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
<p>Or if you are using Conda, at the command line with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>list
</pre></div>
</div>
</section>
<section id="installing-the-latest-develop-version-of-sfrmaker">
<h3>Installing the latest develop version of SFRmaker<a class="headerlink" href="#installing-the-latest-develop-version-of-sfrmaker" title="Link to this heading">¶</a></h3>
<p>In some situations you may want the bleeding-edge version of SFRmaker that is being actively developed on GitHub. For example,
to incorporate a bug fix that was made after the latest release. Pip can also be used to fetch SFRmaker directly from GitHub:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/doi-usgs/sfrmaker@develop
</pre></div>
</div>
<p>(for the develop branch). Subsequent updates can then be made with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>uninstall<span class="w"> </span>sfrmaker
pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/doi-usgs/sfrmaker@develop
</pre></div>
</div>
</section>
<section id="installing-the-sfrmaker-source-code-in-place">
<h3>Installing the SFRmaker source code in-place<a class="headerlink" href="#installing-the-sfrmaker-source-code-in-place" title="Link to this heading">¶</a></h3>
<p>Finally, if you intend to contribute to SFRmaker (please do!) or update your install frequently, the best route is probably to clone the source code from git and install it in place.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/doi-usgs/sfrmaker.git
<span class="nb">cd</span><span class="w"> </span>sfrmaker
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t forget the <code class="docutils literal notranslate"><span class="pre">.</span></code> after <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span></code>!</p>
</div>
<p>Your local copy of the SFRmaker repository can then be subsequently updated with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>pull<span class="w"> </span>origin<span class="w"> </span>master
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are making local changes to SFRmaker that you want to contribute, the workflow is slightly different. See the <a class="reference internal" href="contributing.html#contributing-to-sfrmaker"><span class="std std-ref">Contributing to SFRmaker</span></a> page for more details.</p>
</div>
<p>The advantage of installing the source code in-place is that any changes you make are automatically incorporated into your python environment, without any additional install commands. When debugging in an interactive development environment (IDE) such as Pycharm or VS Code, error tracebacks and inspection features go to the actual source code, not the version installed in the <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> folder. Additionally, since this install is done through pip, <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span></code>
will work to remove the package, and the current version of the package (including the latest commit information) will be visible with <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">list</span></code>.</p>
</section>
</section>
<section id="installing-the-ipython-kernel-to-use-sfrmaker-in-jupyter-notebooks">
<h2>Installing the IPython kernel to use SFRmaker in Jupyter Notebooks<a class="headerlink" href="#installing-the-ipython-kernel-to-use-sfrmaker-in-jupyter-notebooks" title="Link to this heading">¶</a></h2>
<p>This step may not be needed if you already have an existing Python environment with the packages required by SFRmaker <em>and</em> Jupyter Notebook installed. However, if you’d like to use SFRmaker in a Jupyter Notebook with the included <code class="docutils literal notranslate"><span class="pre">sfrmaker</span></code> environment (specified in <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code>), you’ll most likely need to install the IPython kernel in that environment. You can do this at the command line or terminal window (with <code class="docutils literal notranslate"><span class="pre">sfrmaker</span></code> activated):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>ipykernel<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>--name<span class="w"> </span>sfrmaker<span class="w"> </span>--display-name<span class="w"> </span><span class="s2">&quot;sfrmaker&quot;</span>
</pre></div>
</div>
<p>The first instance of <code class="docutils literal notranslate"><span class="pre">sfrmaker</span></code> in this command is the environment to install the kernel to, and the second instance (in quotes) is the name that will appear in the <code class="docutils literal notranslate"><span class="pre">Kernel</span></code> menu within Jupyter Notebook. To use the kernel, simply select it from the <code class="docutils literal notranslate"><span class="pre">Kernel</span> <span class="pre">&gt;</span> <span class="pre">Change</span> <span class="pre">kernel</span></code> menu within  Jupyter Notebook.</p>
</section>
<section id="best-practices">
<h2>Best practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Install the *conda distribution of your choice to your user account, NOT at the system level. Installing to your user means you have rights to delete and reinstall Anaconda as-needed, as well as to edit any configuration files for pip, Conda, etc. Installing at the system level also just seems to lead to more confusing problems with dependencies, at least in the USGS.</p></li>
<li><p>Periodically (maybe a few times a year?) fully remove your *conda distribution and reinstall it. If you just can’t get things to work (packages won’t import or produce DLL errors on import, adding or upgrading a package takes a very long time or results in excessive upgrades or downgrades of other packages, etc.), fully removing and reinstalling *conda just may resolve your issues.</p></li>
<li><p>Don’t use your base environment; create and delete environments as needed. Conda is generally pretty good about managing packages between environments without wasting a lot of disk space.</p></li>
<li><p>Use an environment file (as above) to create a conda environment, instead of installing packages ad-hoc.</p></li>
<li><p>Use Mamba instead of Conda; it just works better for environments with a lot of packages.</p></li>
<li><p>After setting up the above conda environment, scan the screen output to make sure that everything installed correctly, especially the packages installed through pip.</p></li>
<li><p>Avoid mixing package channels within a Conda environment. Strictly sticking to conda-forge may yield the best results.</p></li>
<li><p>Use <a class="reference external" href="https://conda.github.io/conda-pack/">conda-pack</a>, rather than an overly-detailed environment file, to guarantee reproducibility.</p></li>
</ul>
</section>
<section id="considerations-for-usgs-users-or-anyone-else-with-an-organizational-ssl-certificate">
<h2><span class="target" id="considerations-for-usgs-users">Considerations for USGS Users</span> (or anyone else with an organizational SSL certificate)<a class="headerlink" href="#considerations-for-usgs-users-or-anyone-else-with-an-organizational-ssl-certificate" title="Link to this heading">¶</a></h2>
<p>Using conda or pip on the USGS network requires SSL verification, which can cause a number of issues.
If you are encountering persistant issues with creating the conda environment,
you may have better luck trying the install off of the USGS network (e.g. at home).
See <a class="reference external" href="https://tst.usgs.gov/applications/application-and-script-signing/">here</a> for more information
about SSL verification on the USGS network, and to download the DOI SSL certificate. It might be most helpful to consult with your local IT staff; some centers pre-install the appropriate certificate bundle on all new computers.</p>
<section id="id4">
<h3><span class="target" id="installing-the-doi-ssl-certificate-for-use-with-pip">Installing the DOI SSL certificate for use with pip</span><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://tst.usgs.gov/applications/application-and-script-signing/">Download the DOI SSL certificate (internal DOI network only)</a></p></li>
<li><dl class="simple">
<dt>Create a pip configuration file at your user level as described <a class="reference external" href="https://pip.pypa.io/en/stable/topics/configuration/">here</a></dt><dd><ul class="simple">
<li><p>On Windows, this may be <code class="docutils literal notranslate"><span class="pre">C:\Users\&lt;your</span> <span class="pre">username&gt;\AppData\Roaming\pip\pip.ini</span></code>.</p></li>
<li><p>On OSX, this may be <code class="docutils literal notranslate"><span class="pre">/Users/&lt;your</span> <span class="pre">username&gt;/Library/Application</span> <span class="pre">Support/pip/pip.conf</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="k">global</span><span class="p">]</span>
<span class="n">cert</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">DOI</span> <span class="n">certificate</span> <span class="n">bundle</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">cacert_usgs</span><span class="o">.</span><span class="n">pem</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://pip.pypa.io/en/stable/topics/configuration/">More information on the pip configuration file and it’s location</a></p>
<p>You can verify the pip configuration that is being used at a particular location with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">config</span> <span class="nb">list</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you are off the USGS network, you may have to comment out the <code class="docutils literal notranslate"><span class="pre">cert=</span></code> line with a leading <code class="docutils literal notranslate"><span class="pre">#</span></code>
in the above pip configuration file to get <code class="docutils literal notranslate"><span class="pre">pip</span></code> to work.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To test that pip is working, simply try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span></code> on a package of choice; ideally one that is relatively downstream in the dependency stack (for example, <code class="docutils literal notranslate"><span class="pre">gis-utils</span></code>), so as to minimize any additional changes to your environment that may occur.</p>
</div>
</section>
<section id="id5">
<h3><span class="target" id="installing-the-doi-ssl-certificate-for-use-with-git">Installing the DOI SSL certificate for use with git</span><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Using git to reach out to the web also requires the appropriate certificate bundle. This is stored in the git configuration under the <code class="docutils literal notranslate"><span class="pre">http.sslCAinfo</span></code> variable. A valid certificate is needed here to clone and push/pull from git repositories, and also to install packages from git using pip (for example, the entries in <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> starting with <code class="docutils literal notranslate"><span class="pre">git+https://github.com/</span></code>). A missing certificate bundle will cause setup of the <code class="docutils literal notranslate"><span class="pre">sfrmaker</span></code> environment to fail on the pip installs section, even if a valid certificate bundle is specified in the pip configuration bundle. To add your certificate bundle to git:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>http.sslCAinfo<span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>DOI<span class="w"> </span>certificate<span class="w"> </span>bundle<span class="w"> </span><span class="o">(</span>e.g.<span class="w"> </span>cacert_usgs.pem<span class="o">)</span>&gt;
</pre></div>
</div>
<p>You can then verify that the certificate was added by displaying your git configuration</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>config<span class="w"> </span>--list
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To test that both pip and git are working, simply try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span></code> on a package in the pip section of <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> that starts with <code class="docutils literal notranslate"><span class="pre">git+https://</span></code>; for example <code class="docutils literal notranslate"><span class="pre">git+https://github.com/modflowpy/flopy&#64;develop</span></code>.</p>
</div>
</section>
<section id="installing-the-doi-ssl-certificate-for-use-with-conda">
<h3>Installing the DOI SSL certificate for use with conda<a class="headerlink" href="#installing-the-doi-ssl-certificate-for-use-with-conda" title="Link to this heading">¶</a></h3>
<p>See <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html#ssl-verification-ssl-verify">these instructions</a>.
This may or may not work. Basically, <code class="docutils literal notranslate"><span class="pre">ssl_verify:</span></code> needs to be set in your <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html">condarc</a> file to point
to a valid SSL certificate, which may be different from the basic <code class="docutils literal notranslate"><span class="pre">DOIRootCA2.cer</span></code> file.</p>
<p>You can find the location of your <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html">condarc</a> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">info</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<p>which displays information about how Conda is configured. Note that you may have multiple <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html">condarc</a>
files at the system, user and possibly project levels.</p>
<p>Common issues:</p>
<ul>
<li><p>Conda Install fails on the USGS network without a certificate, or with an incorrectly formatted certificate.
Possible solutions are to either get a correctly formatted SSL certificate from your IT person, or try installing off the network.</p></li>
<li><p>Conda Install fails off the USGS network with a certificate (may or may not be correctly formatted). Solution:
open your <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html">condarc</a> file
and comment out the SSL certificate file, if it is specified. E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssl_verify</span><span class="p">:</span> <span class="c1">#D:\certificates\DOIRootCA2.cer</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="troubleshooting-issues-with-the-usgs-network">
<h3>Troubleshooting issues with the USGS network<a class="headerlink" href="#troubleshooting-issues-with-the-usgs-network" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If all else fails, you can simply try running the installs off-network.</p>
</div>
<section id="ssl-related-error-messages-when-using-conda">
<h4>SSL-related error messages when using conda<a class="headerlink" href="#ssl-related-error-messages-when-using-conda" title="Link to this heading">¶</a></h4>
<p>(with <code class="docutils literal notranslate"><span class="pre">SSL</span></code> mentioned in the message and possibly <code class="docutils literal notranslate"><span class="pre">bad</span> <span class="pre">handshake</span></code>)</p>
<p>Make sure that the <code class="docutils literal notranslate"><span class="pre">Conda</span></code> package installer is configured to use the USGS certificate
(see <a class="reference internal" href="#installing-the-doi-ssl-certificate-for-use-with-conda"><span class="std std-ref">Installing the DOI SSL certificate for use with conda</span></a> above).</p>
</section>
<section id="ssl-related-error-messages-when-using-building-a-conda-environment-or-using-pip">
<h4>SSL-related error messages when using building a conda environment or using pip<a class="headerlink" href="#ssl-related-error-messages-when-using-building-a-conda-environment-or-using-pip" title="Link to this heading">¶</a></h4>
<p>If the error message looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Could</span> <span class="ow">not</span> <span class="n">fetch</span> <span class="n">URL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">simple</span><span class="o">/</span><span class="n">pip</span><span class="o">/</span><span class="p">:</span>
<span class="n">There</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span> <span class="n">confirming</span> <span class="n">the</span> <span class="n">ssl</span> <span class="n">certificate</span><span class="p">:</span> <span class="n">HTTPSConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;pypi.org&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">443</span><span class="p">):</span>
<span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">simple</span><span class="o">/</span><span class="n">pip</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">SSLError</span><span class="p">(</span><span class="n">SSLCertVerificationError</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate</span>
<span class="n">verify</span> <span class="n">failed</span><span class="p">:</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">get</span> <span class="n">local</span> <span class="n">issuer</span> <span class="n">certificate</span> <span class="p">(</span><span class="n">_ssl</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">997</span><span class="p">)</span><span class="s1">&#39;))) - skipping</span>
</pre></div>
</div>
<p>Make sure that the <code class="docutils literal notranslate"><span class="pre">pip</span></code> package installer is configured to use the USGS certificate bundle
(see <a class="reference internal" href="#installing-the-doi-ssl-certificate-for-use-with-pip">Installing the DOI SSL certificate for use with pip</a> above).</p>
<p>If the error message looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pip</span> <span class="n">subprocess</span> <span class="n">error</span><span class="p">:</span>
<span class="n">Running</span> <span class="n">command</span> <span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="nb">filter</span><span class="o">=</span><span class="n">blob</span><span class="p">:</span><span class="n">none</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/&lt;</span><span class="n">some</span> <span class="n">package</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="n">fatal</span><span class="p">:</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">access</span> <span class="s1">&#39;https://github.com/&lt;some package&gt;&#39;</span><span class="p">:</span> <span class="n">SSL</span> <span class="n">certificate</span> <span class="n">problem</span><span class="p">:</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">get</span> <span class="n">local</span> <span class="n">issuer</span> <span class="n">certificate</span>
<span class="n">error</span><span class="p">:</span> <span class="n">subprocess</span><span class="o">-</span><span class="n">exited</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">error</span>
<span class="o">...</span>
<span class="n">note</span><span class="p">:</span> <span class="n">This</span> <span class="n">error</span> <span class="n">originates</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">subprocess</span><span class="p">,</span> <span class="ow">and</span> <span class="ow">is</span> <span class="n">likely</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">problem</span> <span class="k">with</span> <span class="n">pip</span><span class="o">.</span>
</pre></div>
</div>
<p>Make sure that git is configured to use the USGS certificate bundle
(see <a class="reference internal" href="#installing-the-doi-ssl-certificate-for-use-with-git">Installing the DOI SSL certificate for use with git</a> above).</p>
</section>
<section id="if-you-are-on-the-usgs-network-using-windows-and-you-get-this-error-message">
<h4>If you are on the USGS network, using Windows, and you get this error message:<a class="headerlink" href="#if-you-are-on-the-usgs-network-using-windows-and-you-get-this-error-message" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>CondaHTTPError: HTTP 500 INTERNAL ERROR for url &lt;<a class="reference external" href="https://repo.anaconda.com/pkgs/msys2/win-64/m2w64-gettext-0.19.7-2.tar.bz2">https://repo.anaconda.com/pkgs/msys2/win-64/m2w64-gettext-0.19.7-2.tar.bz2</a>&gt;
Elapsed: 00:30.647993</p>
<p>An HTTP error occurred when trying to retrieve this URL.
HTTP errors are often intermittent, and a simple retry will get you on your way.</p>
</div></blockquote>
<p>Adding the following line to <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> should work:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">msys2::m2w64-gettext</span>
</pre></div>
</div>
<p>This tells conda to fetch <code class="docutils literal notranslate"><span class="pre">m2w64-gettext</span></code> from the <code class="docutils literal notranslate"><span class="pre">msys2</span></code> channel instead. Note that this is only a dependency on Windows,
so it needs to be commented out on other operating systems (normally it wouldn’t need to be listed, but the above HTTP 500 error indicates that installation from the default source location failed.)</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples.html" class="btn btn-neutral float-left" title="Using SFRmaker with a configuration file" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inputs.html" class="btn btn-neutral float-right" title="Input data requirements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Jan 15, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>