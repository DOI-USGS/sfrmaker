

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic usage of SFRmaker in a scripting context &mdash; SFRmaker 0.6.0.post3.dev0+g9ab5680 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Demonstration of how sfrmaker handles streambed elevations" href="Streambed_elevation_demo.html" />
    <link rel="prev" title="Input data requirements" href="../inputs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> SFRmaker
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0.post3.dev0+g9ab5680
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html"> Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html"> Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"> Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../inputs.html"> Input Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html"> Using SFRmaker with a configuration file</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Basic Usage in a scripting context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Input-requirements">Input requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Hydrography">Hydrography</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-a-Lines-instance-from-NHDPlus">Creating a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance from NHDPlus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-a-Lines-instance-from-custom-hydrography">Creating a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance from custom hydrography</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Specifying-a-model-grid-from-a-flopy-StructuredGrid-instance">Specifying a model grid from a flopy <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Specifying-a-model-grid-from-a-shapefile">Specifying a model grid from a shapefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-the-modelgrid-attached-to-a-flopy-model">Using the <code class="docutils literal notranslate"><span class="pre">modelgrid</span></code> attached to a flopy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Specifying-a-model">Specifying a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-an-SFRData-instance">Creating an SFRData instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-SFRData-class">The <code class="docutils literal notranslate"><span class="pre">SFRData</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sampling-streambed-top-elevations-from-a-DEM">Sampling streambed top elevations from a DEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Assigning-layers-to-the-reaches">Assigning layers to the reaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-diagnostics">Running diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Writing-an-SFR-package">Writing an SFR package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Writing-a-MODFLOW-6-SFR-package">Writing a MODFLOW-6 SFR package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Writing-tables">Writing tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Writing-shapefiles">Writing shapefiles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Streambed_elevation_demo.html"> How the streambed elevation sampling works</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html"> Code reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html"> Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"> Contributing to SFRmaker</a></li>
</ul>
<p class="caption"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html"> References cited</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SFRmaker</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Basic usage of SFRmaker in a scripting context</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/SFRmaker_demo.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Basic-usage-of-SFRmaker-in-a-scripting-context">
<h1>Basic usage of SFRmaker in a scripting context<a class="headerlink" href="#Basic-usage-of-SFRmaker-in-a-scripting-context" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates basic usage of SFRmaker in a scripting context. For examples of using SFRmaker with a configuration file, see the MERAS and Tyler Forks examples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">flopy</span>
<span class="kn">import</span> <span class="nn">sfrmaker</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flopy is installed in /home/travis/miniconda/envs/test/lib/python3.7/site-packages/flopy
</pre></div></div>
</div>
<div class="section" id="Input-requirements">
<h2>Input requirements<a class="headerlink" href="#Input-requirements" title="Permalink to this headline">¶</a></h2>
<p>The most basic input requirements of SFRmaker are hydrography and a model grid. Optionally, a model and a DEM can be input, as demonstrated below. See the <a class="reference external" href="https://aleaf.github.io/sfrmaker/inputs.html">documentation</a> for a more detailed description of inputs.</p>
<div class="section" id="Hydrography">
<h3>Hydrography<a class="headerlink" href="#Hydrography" title="Permalink to this headline">¶</a></h3>
<p>In this example, we will use data that has been downloaded from <a class="reference external" href="https://nhdplus.com/NHDPlus/NHDPlusV2_data.php">NHDPlus</a>. The original file structure in the download has been maintained, allowing us to simply supply SFRmaker with a path to the NHDPlus files:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">NHDPlus_paths</span> <span class="o">=</span> <span class="s1">&#39;../tylerforks/NHDPlus/&#39;</span>
</pre></div>
</div>
</div>
<p>If we were dealing with more than one drainage basin, the NHDPlus file paths could be included in a list:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">NHDPlus_paths_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/NHDPlusGL/NHDPlus04/&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;/NHDPlusMS/NHDPlus07/&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Creating-a-Lines-instance-from-NHDPlus">
<h2>Creating a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance from NHDPlus<a class="headerlink" href="#Creating-a-Lines-instance-from-NHDPlus" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sfrmaker.Lines</span></code> class includes functionality for reading and processing hydrography flowlines. This example shows how to create a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance from NHDPlus data.</p>
<p>For large hydrography datasets, it is advantageous to filter the data when it is read in. The <code class="docutils literal notranslate"><span class="pre">filter</span></code> argument to <code class="docutils literal notranslate"><span class="pre">sfrmaker.Lines</span></code> accepts a shapefile path or tuple of bounding box coordinates. In either case, a bounding box tuple is created and passed to the <code class="docutils literal notranslate"><span class="pre">filter</span></code> method in the <code class="docutils literal notranslate"><span class="pre">`fiona</span></code> package &lt;<a class="reference external" href="https://fiona.readthedocs.io/en/latest/manual.html">https://fiona.readthedocs.io/en/latest/manual.html</a>&gt;`__, which is fast.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lns</span> <span class="o">=</span> <span class="n">sfrmaker</span><span class="o">.</span><span class="n">Lines</span><span class="o">.</span><span class="n">from_nhdplus_v2</span><span class="p">(</span><span class="n">NHDPlus_paths</span><span class="o">=</span><span class="s1">&#39;../tylerforks/NHDPlus/&#39;</span><span class="p">,</span>
                            <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;../tylerforks/grid.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

loading NHDPlus v2 hydrography data...
for basins:
../tylerforks/NHDPlus/

reading ../tylerforks/NHDPlus/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -90.624482596925, 46.37886827710284, -90.4625592199325, 46.45832567355404...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.20s

Getting routing information from NHDPlus Plusflow table...
finished in 0.02s

</pre></div></div>
</div>
<p>Alternatively, <code class="docutils literal notranslate"><span class="pre">sfrmaker.Lines</span></code> can be instantiated with separate arguments for each NHDPlus file used:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lines</span> <span class="o">=</span> <span class="n">sfrmaker</span><span class="o">.</span><span class="n">Lines</span><span class="o">.</span><span class="n">from_nhdplus_v2</span><span class="p">(</span><span class="n">NHDFlowlines</span><span class="o">=</span><span class="s1">&#39;../tylerforks/NHDPlus/NHDSnapshot/Hydrography/NHDFlowline.shp&#39;</span><span class="p">,</span>
                                       <span class="n">PlusFlowlineVAA</span><span class="o">=</span><span class="s1">&#39;../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlowlineVAA.dbf&#39;</span><span class="p">,</span>
                                       <span class="n">PlusFlow</span><span class="o">=</span><span class="s1">&#39;../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlow.dbf&#39;</span><span class="p">,</span>
                                       <span class="n">elevslope</span><span class="o">=</span><span class="s1">&#39;../tylerforks/NHDPlus/NHDPlusAttributes/elevslope.dbf&#39;</span><span class="p">,</span>
                                       <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">90.625</span><span class="p">,</span> <span class="mf">46.3788</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.4634</span><span class="p">,</span> <span class="mf">46.4586</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

loading NHDPlus v2 hydrography data...

reading ../tylerforks/NHDPlus/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -90.625, 46.3788, -90.4634, 46.4586...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/NHDPlus/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.09s

Getting routing information from NHDPlus Plusflow table...
finished in 0.02s

</pre></div></div>
</div>
</div>
<div class="section" id="Creating-a-Lines-instance-from-custom-hydrography">
<h2>Creating a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance from custom hydrography<a class="headerlink" href="#Creating-a-Lines-instance-from-custom-hydrography" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, a <code class="docutils literal notranslate"><span class="pre">Lines</span></code> instance can be created from any hydrography that includes the pertinent attribute fields, which must be specified:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">custom_lines</span> <span class="o">=</span> <span class="n">sfrmaker</span><span class="o">.</span><span class="n">Lines</span><span class="o">.</span><span class="n">from_shapefile</span><span class="p">(</span><span class="n">shapefile</span><span class="o">=</span><span class="s1">&#39;../meras/flowlines.shp&#39;</span><span class="p">,</span>
                                             <span class="n">id_column</span><span class="o">=</span><span class="s1">&#39;COMID&#39;</span><span class="p">,</span>  <span class="c1"># arguments to sfrmaker.Lines.from_shapefile</span>
                                             <span class="n">routing_column</span><span class="o">=</span><span class="s1">&#39;tocomid&#39;</span><span class="p">,</span>
                                             <span class="n">width1_column</span><span class="o">=</span><span class="s1">&#39;width1&#39;</span><span class="p">,</span>
                                             <span class="n">width2_column</span><span class="o">=</span><span class="s1">&#39;width2&#39;</span><span class="p">,</span>
                                             <span class="n">up_elevation_column</span><span class="o">=</span><span class="s1">&#39;elevupsmo&#39;</span><span class="p">,</span>
                                             <span class="n">dn_elevation_column</span><span class="o">=</span><span class="s1">&#39;elevdnsmo&#39;</span><span class="p">,</span>
                                             <span class="n">name_column</span><span class="o">=</span><span class="s1">&#39;GNIS_NAME&#39;</span><span class="p">,</span>
                                             <span class="n">attr_length_units</span><span class="o">=</span><span class="s1">&#39;feet&#39;</span><span class="p">,</span>  <span class="c1"># units of source data</span>
                                             <span class="n">attr_height_units</span><span class="o">=</span><span class="s1">&#39;feet&#39;</span><span class="p">,</span>  <span class="c1"># units of source data</span>
                                             <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

reading ../meras/flowlines.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
</pre></div></div>
</div>
</div>
<div class="section" id="Specifying-a-model-grid-from-a-flopy-StructuredGrid-instance">
<h2>Specifying a model grid from a flopy <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> instance<a class="headerlink" href="#Specifying-a-model-grid-from-a-flopy-StructuredGrid-instance" title="Permalink to this headline">¶</a></h2>
<p>The next step is to specify a model grid. One option is to specify a flopy <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> instance. SFRmaker will then use this internally to create an instance of its own <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> class. In this case, the row and column spacing must be provided in the units of the projected coordinate reference system (CRS) that the model is in, which is typically meters. In this case, our model grid spacing is 250 feet, so we have to convert.</p>
<p>Specifying a CRS (via the <code class="docutils literal notranslate"><span class="pre">proj4</span></code> argument) is also important, as it allows SFRmaker to automatically reproject any input data to the same CRS as the model grid. <a class="reference external" href="https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems">The best way to do this is with an EPSG code</a>, as shown below.</p>
<p>See the flopy documentation for more details about <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">delr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">250</span> <span class="o">*</span> <span class="mf">0.3048</span><span class="p">]</span> <span class="o">*</span> <span class="mi">160</span><span class="p">)</span>  <span class="c1"># cell spacing along a row</span>
<span class="n">delc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">250</span> <span class="o">*</span> <span class="mf">0.3048</span><span class="p">]</span> <span class="o">*</span> <span class="mi">111</span><span class="p">)</span>  <span class="c1"># cell spacing along a column</span>

<span class="n">flopy_grid</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span><span class="n">delr</span><span class="o">=</span><span class="n">delr</span><span class="p">,</span> <span class="n">delc</span><span class="o">=</span><span class="n">delc</span><span class="p">,</span>
                                                 <span class="n">xoff</span><span class="o">=</span><span class="mi">682688</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">5139052</span><span class="p">,</span>  <span class="c1"># lower left corner of model grid</span>
                                                 <span class="n">angrot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># grid is unrotated</span>
                                                 <span class="c1"># projected coordinate system of model (UTM NAD27 zone 15 North)</span>
                                                 <span class="n">proj4</span><span class="o">=</span><span class="s1">&#39;epsg:26715&#39;</span>
                                                 <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Specifying-a-model-grid-from-a-shapefile">
<h2>Specifying a model grid from a shapefile<a class="headerlink" href="#Specifying-a-model-grid-from-a-shapefile" title="Permalink to this headline">¶</a></h2>
<p>Another option is to create an SFRmaker <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> directly using a shapefile. While the basic underpinings are in place for SFRmaker to support unstructured grids, this option hasn’t been fully implemented yet.</p>
<p>Attribute fields with row and column information must be specified. An polygon defining the area where the SFR network will be created can optionally be specified here, or later in the creation of <code class="docutils literal notranslate"><span class="pre">SFRData</span></code> (see below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">sfrmaker</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="o">.</span><span class="n">from_shapefile</span><span class="p">(</span><span class="n">shapefile</span><span class="o">=</span><span class="s1">&#39;../tylerforks/grid.shp&#39;</span><span class="p">,</span>
                                              <span class="n">icol</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span>  <span class="c1"># attribute field with row information</span>
                                              <span class="n">jcol</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">,</span>  <span class="c1"># attribute field with column information</span>
                                              <span class="n">active_area</span><span class="o">=</span><span class="s1">&#39;../tylerforks/active_area.shp&#39;</span>
                                              <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

reading ../tylerforks/grid.shp...
--&gt; building dataframe... (may take a while for large shapefiles)

reading ../tylerforks/active_area.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
</pre></div></div>
</div>
<p>With specification of <code class="docutils literal notranslate"><span class="pre">active_area</span></code>, the grid created above has an <strong>``isfr``</strong> array attribute designating which cells can have SFR:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">isfr</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7f2d0f7f6ed0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_SFRmaker_demo_17_1.png" src="../_images/notebooks_SFRmaker_demo_17_1.png" />
</div>
</div>
</div>
<div class="section" id="Using-the-modelgrid-attached-to-a-flopy-model">
<h2>Using the <code class="docutils literal notranslate"><span class="pre">modelgrid</span></code> attached to a flopy model<a class="headerlink" href="#Using-the-modelgrid-attached-to-a-flopy-model" title="Permalink to this headline">¶</a></h2>
<p>If no grid is supplied as input, SFRmaker will try to use <code class="docutils literal notranslate"><span class="pre">modelgrid</span></code> attribute attached to a supplied flopy model instance. This only works if <code class="docutils literal notranslate"><span class="pre">modelgrid</span></code> is valid. Loading a flopy model with a valid model grid requires the grid information to be specified in the namefile header, and that the model be in the same units as the projected CRS. See the flopy documentation for more details</p>
</div>
<div class="section" id="Specifying-a-model">
<h2>Specifying a model<a class="headerlink" href="#Specifying-a-model" title="Permalink to this headline">¶</a></h2>
<p>While a model is not required to run SFRmaker, specifying a model is advantageous in that it allows SFRmaker to assign valid model layers for reaches. Models are specified as flopy model instances, which can be loaded or created from scratch (see the flopy documentation). In this case, we are loading a model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;tf.nam&#39;</span><span class="p">,</span> <span class="n">model_ws</span><span class="o">=</span><span class="s1">&#39;../tylerforks/tylerforks&#39;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MODFLOW 5 layer(s) 111 row(s) 160 column(s) 1 stress period(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Creating-an-SFRData-instance">
<h2>Creating an SFRData instance<a class="headerlink" href="#Creating-an-SFRData-instance" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sfrmaker.SFRData</span></code> class is the primary object for creating or modifying an SFR dataset. A <code class="docutils literal notranslate"><span class="pre">SFRData</span></code> instance can be created from the <code class="docutils literal notranslate"><span class="pre">Lines</span></code> class using the <code class="docutils literal notranslate"><span class="pre">to_sfr()</span></code> method.</p>
<p>Either a flopy <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> or sfrmaker <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code> can be supplied. While MODFLOW and flopy support specification of length units, these aren’t always specified in the model input files, so it is good practice to specifiy the units explicitly to SFRmaker.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">to_sfr</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">flopy_grid</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">model_length_units</span><span class="o">=</span><span class="s1">&#39;feet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

SFRmaker version 0.6.0.post3.dev0+g9ab5680

Creating sfr dataset...

Creating grid class instance from flopy Grid instance...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/build/aleaf/sfrmaker/sfrmaker/gis.py:32: UserWarning: The proj_str argument is deprecated, use crs instead.
  warnings.warn(&#39;The proj_str argument is deprecated, use crs instead.&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
grid class created in 0.24s

Model grid information
structured grid
nnodes: 17,760
nlay: 1
nrow: 111
ncol: 160
model length units: undefined
crs: EPSG:26715
bounds: 682688.00, 5139052.00, 694880.00, 5147510.20
active area defined by: all cells

MODFLOW 5 layer(s) 111 row(s) 160 column(s) 1 stress period(s)
Warning: No length units specified in CRS for input LineStrings or length units not recognizeddefaulting to meters.

reprojecting hydrography from
EPSG:4269
to
EPSG:26715


Culling hydrography to active area...
starting lines: 17
remaining lines: 17
finished in 0.00s


Intersecting 17 flowlines with 17,760 grid cells...

Building spatial index...
finished in 1.62s

Intersecting 17 features...
17
finished in 0.09s

Setting up reach data... (may take a few minutes for large grids)
finished in 0.27s

Computing widths...

Dropping 30 reaches with length &lt; 12.50 feet...

Repairing routing connections...
enforcing best segment numbering...

Setting up segment data...
Model grid information
structured grid
nnodes: 17,760
nlay: 1
nrow: 111
ncol: 160
model length units: undefined
crs: EPSG:26715
bounds: 682688.00, 5139052.00, 694880.00, 5147510.20
active area defined by: all cells


Time to create sfr dataset: 2.44s

</pre></div></div>
</div>
</div>
<div class="section" id="The-SFRData-class">
<h2>The <code class="docutils literal notranslate"><span class="pre">SFRData</span></code> class<a class="headerlink" href="#The-SFRData-class" title="Permalink to this headline">¶</a></h2>
<p>Internally, the SFRData class mostly uses the data model for the MODFLOW-2005 style SFR2 package (which includes MODFLOW-NWT), which organizes the input into segments and reaches. Segment and reach data are stored in the <code class="docutils literal notranslate"><span class="pre">reach_data</span></code> and <code class="docutils literal notranslate"><span class="pre">segment_data</span></code> attribute DataFrames. In addition to the MODFLOW-2005 data, reach numbers and their routing connections (as needed for MODFLOW-6) are also stored. On writing of SFR package input, MODFLOW-6 style input can be created via the
<code class="docutils literal notranslate"><span class="pre">sfrmaker.mf5to6</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">reach_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rno</th>
      <th>node</th>
      <th>k</th>
      <th>i</th>
      <th>j</th>
      <th>iseg</th>
      <th>ireach</th>
      <th>rchlen</th>
      <th>width</th>
      <th>slope</th>
      <th>...</th>
      <th>thts</th>
      <th>thti</th>
      <th>eps</th>
      <th>uhc</th>
      <th>outreach</th>
      <th>outseg</th>
      <th>asum</th>
      <th>line_id</th>
      <th>name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>465</th>
      <td>1</td>
      <td>13279</td>
      <td>0</td>
      <td>82</td>
      <td>159</td>
      <td>1</td>
      <td>1</td>
      <td>29.298670</td>
      <td>1.000000</td>
      <td>0.046346</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2</td>
      <td>4</td>
      <td>4.465117</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694812.4654293101 5141215.339454...</td>
    </tr>
    <tr>
      <th>466</th>
      <td>2</td>
      <td>13278</td>
      <td>0</td>
      <td>82</td>
      <td>158</td>
      <td>1</td>
      <td>2</td>
      <td>258.714050</td>
      <td>1.000000</td>
      <td>0.008519</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3</td>
      <td>4</td>
      <td>48.358253</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694803.8 5141213.18088425 0, 694...</td>
    </tr>
    <tr>
      <th>467</th>
      <td>3</td>
      <td>13277</td>
      <td>0</td>
      <td>82</td>
      <td>157</td>
      <td>1</td>
      <td>3</td>
      <td>208.741928</td>
      <td>1.324805</td>
      <td>0.009116</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
      <td>119.598541</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694727.6 5141219.032934831 0, 69...</td>
    </tr>
    <tr>
      <th>468</th>
      <td>4</td>
      <td>13437</td>
      <td>0</td>
      <td>83</td>
      <td>157</td>
      <td>1</td>
      <td>4</td>
      <td>194.894043</td>
      <td>1.632452</td>
      <td>0.007749</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5</td>
      <td>4</td>
      <td>181.112671</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694678.3688327055 5141185.6 0, 6...</td>
    </tr>
    <tr>
      <th>469</th>
      <td>5</td>
      <td>13436</td>
      <td>0</td>
      <td>83</td>
      <td>156</td>
      <td>1</td>
      <td>5</td>
      <td>125.442345</td>
      <td>1.840760</td>
      <td>0.011187</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6</td>
      <td>4</td>
      <td>229.931931</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694651.4 5141132.737158341 0, 69...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">segment_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>per</th>
      <th>nseg</th>
      <th>icalc</th>
      <th>outseg</th>
      <th>iupseg</th>
      <th>iprior</th>
      <th>nstrpts</th>
      <th>flow</th>
      <th>runoff</th>
      <th>etsw</th>
      <th>...</th>
      <th>uhc1</th>
      <th>hcond2</th>
      <th>thickm2</th>
      <th>elevdn</th>
      <th>width2</th>
      <th>depth2</th>
      <th>thts2</th>
      <th>thti2</th>
      <th>eps2</th>
      <th>uhc2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1278.149658</td>
      <td>23.194326</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1278.149658</td>
      <td>126.765388</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1211.286133</td>
      <td>21.228680</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1211.286133</td>
      <td>129.970474</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1162.926514</td>
      <td>25.381979</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 35 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Sampling-streambed-top-elevations-from-a-DEM">
<h2>Sampling streambed top elevations from a DEM<a class="headerlink" href="#Sampling-streambed-top-elevations-from-a-DEM" title="Permalink to this headline">¶</a></h2>
<p>While the above dataset contains streambed top elevations read from NHDPlus, a DEM can be sampled to obtain more accurate elevations. If the DEM elevation units are specified, SFRmaker will convert the elevations to model units if needed. See the Streambed_elevation_demo notebook for more information on how this works.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">set_streambed_top_elevations_from_dem</span><span class="p">(</span><span class="s1">&#39;../tylerforks/dem_26715.tif&#39;</span><span class="p">,</span> <span class="n">dem_z_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
running rasterstats.zonal_stats on buffered LineStrings...
finished in 3.60s


Smoothing elevations...
finished in 0.14s
</pre></div></div>
</div>
</div>
<div class="section" id="Assigning-layers-to-the-reaches">
<h2>Assigning layers to the reaches<a class="headerlink" href="#Assigning-layers-to-the-reaches" title="Permalink to this headline">¶</a></h2>
<p>Once we have a valid set of streambed elevations, the reaches can be assigned to model layers.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">assign_layers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">reach_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rno</th>
      <th>node</th>
      <th>k</th>
      <th>i</th>
      <th>j</th>
      <th>iseg</th>
      <th>ireach</th>
      <th>rchlen</th>
      <th>width</th>
      <th>slope</th>
      <th>...</th>
      <th>thts</th>
      <th>thti</th>
      <th>eps</th>
      <th>uhc</th>
      <th>outreach</th>
      <th>outseg</th>
      <th>asum</th>
      <th>line_id</th>
      <th>name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>465</th>
      <td>1</td>
      <td>13279</td>
      <td>2</td>
      <td>82</td>
      <td>159</td>
      <td>1</td>
      <td>1</td>
      <td>29.298670</td>
      <td>1.000000</td>
      <td>0.046346</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2</td>
      <td>4</td>
      <td>4.465117</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694812.4654293101 5141215.339454...</td>
    </tr>
    <tr>
      <th>466</th>
      <td>2</td>
      <td>13278</td>
      <td>2</td>
      <td>82</td>
      <td>158</td>
      <td>1</td>
      <td>2</td>
      <td>258.714050</td>
      <td>1.000000</td>
      <td>0.008519</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3</td>
      <td>4</td>
      <td>48.358253</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694803.8 5141213.18088425 0, 694...</td>
    </tr>
    <tr>
      <th>467</th>
      <td>3</td>
      <td>13277</td>
      <td>2</td>
      <td>82</td>
      <td>157</td>
      <td>1</td>
      <td>3</td>
      <td>208.741928</td>
      <td>1.324805</td>
      <td>0.009116</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
      <td>119.598541</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694727.6 5141219.032934831 0, 69...</td>
    </tr>
    <tr>
      <th>468</th>
      <td>4</td>
      <td>13437</td>
      <td>2</td>
      <td>83</td>
      <td>157</td>
      <td>1</td>
      <td>4</td>
      <td>194.894043</td>
      <td>1.632452</td>
      <td>0.007749</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5</td>
      <td>4</td>
      <td>181.112671</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694678.3688327055 5141185.6 0, 6...</td>
    </tr>
    <tr>
      <th>469</th>
      <td>5</td>
      <td>13436</td>
      <td>2</td>
      <td>83</td>
      <td>156</td>
      <td>1</td>
      <td>5</td>
      <td>125.442345</td>
      <td>1.840760</td>
      <td>0.011187</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6</td>
      <td>4</td>
      <td>229.931931</td>
      <td>1815711</td>
      <td>None</td>
      <td>LINESTRING Z (694651.4 5141132.737158341 0, 69...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Running-diagnostics">
<h2>Running diagnostics<a class="headerlink" href="#Running-diagnostics" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">SFRData</span></code> includes a <code class="docutils literal notranslate"><span class="pre">run_diagnostics()</span></code> method that executes the Flopy checker on the SFR package input. While the Flopy checks are only implemented for MODFLOW-2005 style SFR packages, <code class="docutils literal notranslate"><span class="pre">run_diagnostics()</span></code> works on MODFLOW-6 packages as well, by working of an attached MODFLOW-2005 representation of the MODFLOW-6 SFR input. The following checks are executed: * <strong>NaNs</strong> (not a number values, which will cause MODFLOW to crash) * <strong>consecutive segment and reach numbering</strong> * <strong>segment
numbering that only increases</strong> in the downstream direction * <strong>circular routing sequences</strong> (reaches or segments routing back to themselves) * <strong>routing connection proximity:</strong> The length of routing connections, as determined by the distance between their cell centers, is compared to 1.25 times the diagonal distance across the cell containing the upstream reach. This benchmark length is equivalent to a diagonal connection between two square cells, where one cell had a spacing of 1.5 times the
other cell (the maximum recommended increase in spacing between two adjacent cells; see Anderson and others, 2015). While this routing proximity check can be helpful for identifying egregious routing issues, in practice, it may not be uncommon for valid routing connections to violate this rule. For example, if the <code class="docutils literal notranslate"><span class="pre">one_reach_per_cell</span></code> option is used in constructing the SFR package with a large grid size, there may be numerous routing connections that extend across several cells. When
non-adjacent routing connections are identified, the user can check the shapefile of routing connections to verify the results. * <strong>overlapping conductances:</strong> This check identifies instances of collocated reaches, where more than one reach has a connection to the groundwater flow solution in that cell. Collocated reaches may or may not present an issue for a particular model solution, but can potentially promote instability or spurious circulation of flow between the collocated reaches. *
<strong>spurious streambed top elevations:</strong> Values &lt; -10 or &gt; 15,000 are flagged * <strong>downstream rises in streambed elevation</strong> * <strong>inconsistencies between streambed elevation and the model grid:</strong> This check looks for streambed bottoms below their respective cell bottoms, which will cause MODFLOW to halt execution, and streambed tops that are above the model top. The latter issue will not prevent MODFLOW from running, but may indicate problems with the input if the differences are large. For coarse
grids in areas of high stream density (where there are often multiple streams in a cell), it may be impossible to ensure that all streambed top elevations are at or below the model top. Oftentimes, these reaches are dry anyways (for example, and ephemeral gully that runs off a bluff into a perennial stream, where the cell elevation is based on the elevation of the perennial stream). In any case, it is good practice to check the largest violations by comparing the SFRmaker shapefile output to a
DEM and other data in a GIS environment. * <strong>suprious slopes:</strong> slopes of less than 0.0001 (which can lead to excessive stages with the SFR package’s Manning approximation) and greater than 1.0 are flagged.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">run_diagnostics</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Running Flopy v. 3.3.1 diagnostics...
wrote tf_SFR.chk
</pre></div></div>
</div>
</div>
<div class="section" id="Writing-an-SFR-package">
<h2>Writing an SFR package<a class="headerlink" href="#Writing-an-SFR-package" title="Permalink to this headline">¶</a></h2>
<p>Now we can write the package. By default, a MODFLOW-2005 style package is written to the current working directory or the model workspace of the attached model instance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">write_package</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SFRmaker v. 0.6.0.post3.dev0+g9ab5680

Running Flopy v. 3.3.1 diagnostics...
passed.

Checking for continuity in segment and reach numbering...
passed.

Checking for increasing segment numbers in downstream direction...
passed.

Checking for circular routing...
passed.

No DIS package or SpatialReference object; cannot check reach proximities.

Checking for model cells with multiple non-zero SFR conductances...
20 model cells with multiple non-zero SFR conductances found.
This may lead to circular routing between collocated reaches.
Nodes with overlapping conductances:
k       i       j       iseg    ireach  rchlen  strthick        strhc1
0       87      122     1       54      35.61542510986328       1.0     1.0
0       87      122     2       34      230.8770751953125       1.0     1.0
0       76      110     3       47      204.68466186523438      1.0     1.0
0       87      122     4       1       30.619203567504883      1.0     1.0
2       84      119     4       7       271.296630859375        1.0     1.0
2       84      119     4       9       26.846023559570312      1.0     1.0
0       76      110     4       27      75.61869812011719       1.0     1.0
1       58      132     5       25      42.411964416503906      1.0     1.0
1       58      132     5       27      88.49227905273438       1.0     1.0
0       48      109     5       64      251.07437133789062      1.0     1.0
0       76      110     6       1       69.44449615478516       1.0     1.0
0       48      108     6       40      20.661043167114258      1.0     1.0
0       48      109     6       41      114.03108978271484      1.0     1.0
0       48      108     6       42      35.86711502075195       1.0     1.0
1       80      49      7       70      159.628662109375        1.0     1.0
0       48      108     8       1       125.59841918945312      1.0     1.0
0       47      98      8       22      67.49517059326172       1.0     1.0
0       47      98      8       24      102.60327911376953      1.0     1.0
0       54      89      8       39      35.04909896850586       1.0     1.0
0       54      89      8       41      62.93534851074219       1.0     1.0
0       53      78      8       57      61.92954635620117       1.0     1.0
0       53      78      8       59      28.305360794067383      1.0     1.0
0       52      76      8       62      63.750675201416016      1.0     1.0
0       52      76      8       64      294.7840270996094       1.0     1.0
1       54      73      8       69      341.07586669921875      1.0     1.0
1       54      73      8       71      27.020740509033203      1.0     1.0
1       80      49      8       125     39.87680435180664       1.0     1.0
2       108     57      9       8       237.81178283691406      1.0     1.0
2       108     57      9       9       46.60417556762695       1.0     1.0
0       94      35      9       45      96.37408447265625       1.0     1.0
0       94      35      9       47      89.41510009765625       1.0     1.0
2       91      35      9       50      60.342041015625 1.0     1.0
2       91      34      9       51      61.56704330444336       1.0     1.0
1       80      49      10      1       146.53265380859375      1.0     1.0
2       91      35      10      26      308.05096435546875      1.0     1.0
2       91      34      10      27      76.15687561035156       1.0     1.0
0       38      85      11      8       72.13273620605469       1.0     1.0
0       38      85      11      9       52.62028121948242       1.0     1.0
2       25      24      13      42      95.18097686767578       1.0     1.0
2       25      24      14      47      230.81414794921875      1.0     1.0
2       19      23      16      47      12.734856605529785      1.0     1.0
2       19      23      16      49      108.90869903564453      1.0     1.0
2       91      34      17      1       130.4016571044922       1.0     1.0
1       92      30      17      6       67.78282165527344       1.0     1.0
1       92      30      17      8       252.36495971679688      1.0     1.0

Checking for streambed tops of less than -10...
passed.

Checking for streambed tops of greater than 15000...
passed.

Checking segment_data for downstream rises in streambed elevation...
Segment elevup and elevdn not specified for nstrm=-965 and isfropt=1
passed.

Checking reach_data for downstream rises in streambed elevation...
passed.

Checking reach_data for inconsistencies between streambed elevations and the model grid...
passed.

Checking segment_data for inconsistencies between segment end elevations and the model grid...
Segment elevup and elevdn not specified for nstrm=-965 and isfropt=1
passed.

Checking for streambed slopes of less than 0.0001...
passed.

Checking for streambed slopes of greater than 1.0...
passed.

wrote tf_SFR.chk
wrote ../tylerforks/tylerforks/tf.sfr.
</pre></div></div>
</div>
</div>
<div class="section" id="Writing-a-MODFLOW-6-SFR-package">
<h2>Writing a MODFLOW-6 SFR package<a class="headerlink" href="#Writing-a-MODFLOW-6-SFR-package" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, a MODFLOW-6 style SFR package can be written by specifying <code class="docutils literal notranslate"><span class="pre">version='mf6'</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">write_package</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;mf6&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SFRmaker v. 0.6.0.post3.dev0+g9ab5680

Running Flopy v. 3.3.1 diagnostics...
passed.

Checking for continuity in segment and reach numbering...
passed.

Checking for increasing segment numbers in downstream direction...
passed.

Checking for circular routing...
passed.

No DIS package or SpatialReference object; cannot check reach proximities.

Checking for model cells with multiple non-zero SFR conductances...
20 model cells with multiple non-zero SFR conductances found.
This may lead to circular routing between collocated reaches.
Nodes with overlapping conductances:
k       i       j       iseg    ireach  rchlen  strthick        strhc1
0       87      122     1       54      35.61542510986328       1.0     1.0
0       87      122     2       34      230.8770751953125       1.0     1.0
0       76      110     3       47      204.68466186523438      1.0     1.0
0       87      122     4       1       30.619203567504883      1.0     1.0
2       84      119     4       7       271.296630859375        1.0     1.0
2       84      119     4       9       26.846023559570312      1.0     1.0
0       76      110     4       27      75.61869812011719       1.0     1.0
1       58      132     5       25      42.411964416503906      1.0     1.0
1       58      132     5       27      88.49227905273438       1.0     1.0
0       48      109     5       64      251.07437133789062      1.0     1.0
0       76      110     6       1       69.44449615478516       1.0     1.0
0       48      108     6       40      20.661043167114258      1.0     1.0
0       48      109     6       41      114.03108978271484      1.0     1.0
0       48      108     6       42      35.86711502075195       1.0     1.0
1       80      49      7       70      159.628662109375        1.0     1.0
0       48      108     8       1       125.59841918945312      1.0     1.0
0       47      98      8       22      67.49517059326172       1.0     1.0
0       47      98      8       24      102.60327911376953      1.0     1.0
0       54      89      8       39      35.04909896850586       1.0     1.0
0       54      89      8       41      62.93534851074219       1.0     1.0
0       53      78      8       57      61.92954635620117       1.0     1.0
0       53      78      8       59      28.305360794067383      1.0     1.0
0       52      76      8       62      63.750675201416016      1.0     1.0
0       52      76      8       64      294.7840270996094       1.0     1.0
1       54      73      8       69      341.07586669921875      1.0     1.0
1       54      73      8       71      27.020740509033203      1.0     1.0
1       80      49      8       125     39.87680435180664       1.0     1.0
2       108     57      9       8       237.81178283691406      1.0     1.0
2       108     57      9       9       46.60417556762695       1.0     1.0
0       94      35      9       45      96.37408447265625       1.0     1.0
0       94      35      9       47      89.41510009765625       1.0     1.0
2       91      35      9       50      60.342041015625 1.0     1.0
2       91      34      9       51      61.56704330444336       1.0     1.0
1       80      49      10      1       146.53265380859375      1.0     1.0
2       91      35      10      26      308.05096435546875      1.0     1.0
2       91      34      10      27      76.15687561035156       1.0     1.0
0       38      85      11      8       72.13273620605469       1.0     1.0
0       38      85      11      9       52.62028121948242       1.0     1.0
2       25      24      13      42      95.18097686767578       1.0     1.0
2       25      24      14      47      230.81414794921875      1.0     1.0
2       19      23      16      47      12.734856605529785      1.0     1.0
2       19      23      16      49      108.90869903564453      1.0     1.0
2       91      34      17      1       130.4016571044922       1.0     1.0
1       92      30      17      6       67.78282165527344       1.0     1.0
1       92      30      17      8       252.36495971679688      1.0     1.0

Checking for streambed tops of less than -10...
passed.

Checking for streambed tops of greater than 15000...
passed.

Checking segment_data for downstream rises in streambed elevation...
Segment elevup and elevdn not specified for nstrm=-965 and isfropt=1
passed.

Checking reach_data for downstream rises in streambed elevation...
passed.

Checking reach_data for inconsistencies between streambed elevations and the model grid...
passed.

Checking segment_data for inconsistencies between segment end elevations and the model grid...
Segment elevup and elevdn not specified for nstrm=-965 and isfropt=1
passed.

Checking for streambed slopes of less than 0.0001...
passed.

Checking for streambed slopes of greater than 1.0...
passed.

wrote tf_SFR.chk
converting segment data to period data...
converting reach and segment data to package data...
wrote ../tylerforks/tylerforks/tf.sfr
</pre></div></div>
</div>
</div>
<div class="section" id="Writing-tables">
<h2>Writing tables<a class="headerlink" href="#Writing-tables" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">reach_data</span></code> and <code class="docutils literal notranslate"><span class="pre">segment_data</span></code> tables can be written out to csv files for further processing:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">write_tables</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wrote tables/tf_sfr_reach_data.csv
wrote tables/tf_sfr_segment_data.csv
</pre></div></div>
</div>
<p>and then read back in to create an <code class="docutils literal notranslate"><span class="pre">SFRData</span></code> instance</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata2</span> <span class="o">=</span> <span class="n">sfrmaker</span><span class="o">.</span><span class="n">SFRData</span><span class="o">.</span><span class="n">from_tables</span><span class="p">(</span><span class="s1">&#39;tables/tf_sfr_reach_data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;tables/tf_sfr_segment_data.csv&#39;</span><span class="p">,</span>
                                        <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model grid information
structured grid
nnodes: 17,760
nlay: 1
nrow: 111
ncol: 160
model length units: undefined
crs: EPSG:26715
bounds: 682688.00, 5139052.00, 694880.00, 5147510.20
active area defined by: isfr array

</pre></div></div>
</div>
</div>
<div class="section" id="Writing-shapefiles">
<h2>Writing shapefiles<a class="headerlink" href="#Writing-shapefiles" title="Permalink to this headline">¶</a></h2>
<p>Shapefiles can also be written to visualize the SFR package. These include: * hydrography linestrings associated with each reach * model cell polygons associated with each reach * outlet locations where water is leaving the model * routing connections (as lines drawn between cell centers) * the locations of specified inflows or any other period data * observation locations (if observations were supplied as input)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sfrdata</span><span class="o">.</span><span class="n">write_shapefiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing shps/tf_sfr_cells.shp...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/miniconda/envs/test/lib/python3.7/site-packages/pyproj/crs/crs.py:543: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
  proj_string = self.to_proj4()
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing shps/tf_sfr_outlets.shp...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/miniconda/envs/test/lib/python3.7/site-packages/pyproj/crs/crs.py:543: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
  proj_string = self.to_proj4()
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing shps/tf_sfr_lines.shp...
writing shps/tf_sfr_routing.shp...
No period data to export!
No observations to export!
No non-zero values of flow to export!
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Streambed_elevation_demo.html" class="btn btn-neutral float-right" title="Demonstration of how sfrmaker handles streambed elevations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../inputs.html" class="btn btn-neutral float-left" title="Input data requirements" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Oct 20, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>